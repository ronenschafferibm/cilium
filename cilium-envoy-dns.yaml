node:
  id: host~127.0.0.1~no-id~localdomain
  cluster: ingress-cluster
static_resources:
  listeners:
  - name: 0.0.0.0:1234    
    use_original_dst: true
    address:
      socket_address:
        address: "0.0.0.0"
        port_value: 1234
        ipv4_compat: true
    filter_chains:
    - filters:
        - name: envoy.tcp_proxy
          config:
            # Shouldn't get to here
            stat_prefix: tcp_proxy
            cluster: pythonServer
  - name: 0.0.0.0:53
    address:
      socket_address:
        address: "0.0.0.0"
        port_value: 53
        ipv4_compat: true
    filter_chains:
    - filters:
      - name: cilium.network
        config:
          proxylib: libcilium.so
          l7_proto: dns
          policy_name: 127.0.0.1
      - name: envoy.tcp_proxy
        config:
          stat_prefix: tcp_proxy
          cluster: dns-google
    listener_filters:
    - name: cilium.bpf_metadata
      # config:
        # bpf_root: "/sys/fs/bpf"
        # is_ingress: true
  clusters:
  - name: xds-grpc-cilium
    connect_timeout: 1s
    hosts:
    - pipe:
        path: "/var/run/cilium/xds.sock"
    http2_protocol_options: {}
#  - name: pythonServer
#    connect_timeout: 1s
#    type: static
#    hosts:
#      - socket_address:
#          address: 127.0.0.1
#          port_value: 9999
#    dns_lookup_family: "v4_only"
#  - name: google
#    connect_timeout: 1s
#    type: strict_dns
#    hosts:
#      - socket_address:
#          address: "www.google.com"
#          port_value: 80
#    dns_lookup_family: "v4_only"
  - name: dns-google
    connect_timeout: 1s
    type: static
    hosts:
      - socket_address:
          address: 8.8.8.8
          port_value: 53
    dns_lookup_family: "v4_only"
    
admin:
  access_log_path: "/dev/null"
  address:
    socket_address:
      address: 127.0.0.1
      port_value: 8081